# Chapter1 Hello wrold

## Vimでバイナリファイルを編集する

### バイナリモードで開く

```
$ vim -b BOOTX64.EFI
```

### `xxd` バイナリ形式->テキスト形式 変換

```
:%!xxd
```

### `xxd` テキスト形式->バイナリ形式 変換

```
:%!xxd
```

> **_NOTE:_**  保存を忘れずに

## USBメモリの準備

> **_NOTE:_**  デバイス名を絶対に間違えないこと

### `dd` USBメモリをフォーマット

isoを書き込んだUSBメモリはフォーマットが必要

```
$ sudo dd if=/dev/zero of=/dev/sda status=progress bs=32M
$ sync
```


### BOOTX64.EFIをUSBメモリにコピー

```
$ sudo mkfs.fat /dev/sda
$ sudo mkdir -p /mnt/usbmem
$ sudo mount /dev/sda /mnt/usbmem
$ sudo mkdir -p /mnt/usbmem/EFI/BOOT
$ sudo cp BOOTX64.EFI /mnt/usbmem/EFI/BOOT
$ sudo umount /mnt/usbmem
```

## `dd`コマンドのbsの最適な値を調べるスクリプト

```
#!/bin/bash
#
#create a file to work with
#
echo "creating a file to work with"
dd if=/dev/zero of=/tmp/infile count=1175000

for bs in 16M 32M 64M 128M 256M 512M

do
    echo "---------------------------------------"
    echo "Testing block size  = $bs"
    dd if=/tmp/infile of=/tmp/outfile bs=$bs
    echo ""
done
rm /tmp/infile /tmp/outfile
```


## BOOTX64.EFIのテキスト形式

```
00000000: 4d5a 0000 0000 0000 0000 0000 0000 0000  MZ..............
00000010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000030: 0000 0000 0000 0000 0000 0000 8000 0000  ................
00000040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000080: 5045 0000 6486 0200 0000 0000 0000 0000  PE..d...........
00000090: 0000 0000 f000 2202 0b02 0000 0002 0000  ......".........
000000a0: 0002 0000 0000 0000 0010 0000 0010 0000  ................
000000b0: 0000 0040 0100 0000 0010 0000 0002 0000  ...@............
000000c0: 0000 0000 0000 0000 0600 0000 0000 0000  ................
000000d0: 0030 0000 0002 0000 0000 0000 0a00 6081  .0............`.
000000e0: 0000 1000 0000 0000 0010 0000 0000 0000  ................
000000f0: 0000 1000 0000 0000 0010 0000 0000 0000  ................
00000100: 0000 0000 1000 0000 0000 0000 0000 0000  ................
00000110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000180: 0000 0000 0000 0000 2e74 6578 7400 0000  .........text...
00000190: 1400 0000 0010 0000 0002 0000 0002 0000  ................
000001a0: 0000 0000 0000 0000 0000 0000 2000 5060  ............ .P`
000001b0: 2e72 6461 7461 0000 1c00 0000 0020 0000  .rdata....... ..
000001c0: 0002 0000 0004 0000 0000 0000 0000 0000  ................
000001d0: 0000 0000 4000 5040 0000 0000 0000 0000  ....@.P@........
000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000200: 4883 ec28 488b 4a40 488d 15f1 0f00 00ff  H..(H.J@H.......
00000210: 5108 ebfe 0000 0000 0000 0000 0000 0000  Q...............
00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000002a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000002b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000002c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000002d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000002e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000002f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000003a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000400: 4800 6500 6c00 6c00 6f00 2c00 2000 7700  H.e.l.l.o.,. .w.
00000410: 6f00 7200 6c00 6400 2100 0000 0000 0000  o.r.l.d.!.......
00000420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000004d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000004e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000004f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000005a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000005b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000005c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000005d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000005e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000005f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```
